# TCACHE
```
Security check: every thing is on
```
![image](https://user-images.githubusercontent.com/93699926/227400598-3870db9b-a185-42b3-8d3e-8411f682404c.png)
```
like before challenges , this time we still has 4 main function in the binary file create ,show,edit and delete
Check out the delete function we see this
```
![image](https://user-images.githubusercontent.com/93699926/227400789-20e1313d-0540-4f0c-9582-012e01a2c074.png)
``` 
All it do is check if at Store[index] has a pointer to the heap and then free that chunk but it do not set NULL the pointer to that chunk
==> use after free
And in this challenge we dealing with libc-2.28 which mean tcache is enabled
if we free a chunk in tcache thread heap it will go in that tcache thread bin
and in tcache bin the the foward pointer of it point to the heap address which containing the data ( different from the the fastbin where the pointer point to the
metadata section of a chunk)
And one more thing that is tcache has no double free investigation which will make our exploit easier
So our a plan first is to leak the libc address
we know that a thread of tcache heap bin only can contain of seven chunk of that size(0x10-0x410) and in this challenge the create heap function is designed to malloc 
chunks of size 0x80(+ 16 byte of metadata will be 0x90) by its self but we know that every chunk is > 0x80 if not go in tcache thread it will go in unsorted bin
and because we has a use after free bug we can leak the address of libc easily
```
![image](https://user-images.githubusercontent.com/93699926/227402887-76039523-3765-4780-a475-189a305d16a9.png)
![image](https://user-images.githubusercontent.com/93699926/227403083-d6af5650-9ba5-4c1f-8fd7-6299bc139672.png)
``` 
we see that the 8th chunk we free has go in unsored bin
Now we can leak address of libc 
```
![image](https://user-images.githubusercontent.com/93699926/227403493-7e219c29-5497-454b-9050-287c25df481e.png)
```
this part we got every things out of tcache bin
and just leak libc
```
![image](https://user-images.githubusercontent.com/93699926/227403626-5a1d0395-4561-424d-a1e7-d89d990ab8cf.png)
``` 
like i mentioned earlier that tcache heap pointer point to the address which contain data so we can just overwrite that address using double free bug with the _free_hook
its self instead of __free_hook -16 like before
Run the script and we pwned a shell
```
![image](https://user-images.githubusercontent.com/93699926/227403999-384b58f0-b16e-49dd-a06e-20b0e2106a70.png)

